<%
const { contract, utils } = it;
const { formatDescription, require, _ } = utils;

const buildGenerics = (contract) => {
  if (!contract.genericArgs || !contract.genericArgs.length) return '';

  return '<' + contract.genericArgs.map(({ name, default: defaultType, extends: extendsType }) => {
    return [
      name,
      extendsType && `extends ${extendsType}`,
      defaultType && `= ${defaultType}`,
    ].join('')
  }).join(',') + '>'
}

// Check if field is optional: either explicitly nullable, or its value includes 'null' (OpenAPI 3.1 style)
const isOptional = (field) => {
  return field.nullable || field.isNullable || (field.value && field.value.includes('null'));
}
%>
interface <%~ contract.name %><%~ buildGenerics(contract) %> {
<% for (const field of contract.$content) { %>
<%~ includeFile('@base/object-field-jsdoc.ejs', { ...it, field }) %>
    <%~ field.name %><%~ isOptional(field) ? '?' : '' %>: <%~ field.value.replaceAll('any', 'unknown') %>;
<% } %>
}
